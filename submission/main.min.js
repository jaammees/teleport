var g_scene=null;var g_vrMode=-1;var energyDiv=null;var ENERGY_MAX=8;var mouseDownCount=0;AFRAME.registerComponent("game",{init:function(){g_scene=document.querySelector("a-scene");energyDiv=document.createElement("div");energyDiv.setAttribute("id","infoPanel");energyDiv.setAttribute("style","position: absolute; top: 0; left: 0; right: 0; height: 50px; display: flex; flex-direction: column; align-items: center; justify-content: center;  color: white; font-family: arial, helvetica, sans-serif");var e="";e+='<div style="display: flex; margin-bottom: 6px">';e+='<div style="margin-right: 6px; display: flex; align-items: center">Energy</div>';e+='<div style="display: flex; align-items: center">';for(var t=0;t<8;t++){e+='<div id="energy_'+t+'" style="width: 16px; height: 16px; background-color: #0f0; margin-right: 4px"></div>'}e+="</div>";e+='<div id="restart-button" style="display: flex; align-items: center; margin-left: 8px; cursor: pointer; height: 20px; color: #eee; background-color: #333; padding: 6px">Restart Level</div>';e+="</div>";e+='<div style="display: flex" id="instructions"></div>';energyDiv.innerHTML=e;document.body.appendChild(energyDiv);document.getElementById("restart-button").addEventListener("click",function(e){g_playfield.restartLevel()});g_playfield=new Playfield;g_playfield.init();g_sound=new Sound;document.addEventListener("mousedown",function(e){if(!g_vrMode){if(mouseDownCount==0){mouseDownCount++;g_playfield.buttonDown(e)}}});document.addEventListener("mouseup",function(e){if(!g_vrMode){if(mouseDownCount>0){mouseDownCount--}g_playfield.buttonUp(e)}})},tick:function(e,t){if(g_scene.is("vr-mode")){if(g_vrMode===false||g_vrMode===-1){g_vrMode=true;energyDiv.style.display="none";g_playfield.modeChange()}}else{if(g_vrMode===true||g_vrMode===-1){g_vrMode=false;energyDiv.style.display="flex";g_playfield.modeChange()}}if(g_playfield==null){}while(t>0){var r=40;if(r>t){r=t}t-=r;g_playfield.tick(e,r)}}});var g_startLevel=0;var g_playfield=null;var g_playfieldScale=1;var g_raycaster=null;var g_leftButtonDownCount=0;var g_rightButtonDownCount=0;var STATE_LEVEL_PREVIEW=0;var STATE_PLAYING=1;var STATE_IN_TELEPORT=2;var STATE_LEVEL_FINISHED=3;var STATE_TELEPORT_NEXT=4;var STATE_GAME_OVER=5;var Playfield=function(){var o=0;var l=false;var s=true;var u=false;var c=false;var f=false;var v=false;var E=false;var d=this;var e=-1;var g=null;var A=STATE_LEVEL_PREVIEW;var T=new THREE.Vector3;var b=new THREE.Vector3;var a=0;var n=0;var p=0;var m=0;var _=null;var y=null;var h=false;var D=false;var R=null;var P=null;var w=null;var S=null;var L=[];var O=[];var V=null;var N=null;var I=null;var t=new THREE.Vector3;var x=new THREE.Vector3;var M=null;var i=null;var H=null;var k=null;var B=null;var G=null;var C=null;var j=null;var z=[];var U=false;var Y=false;var W=g_scene.object3D;var q=[];var K=new THREE.Vector3;var X=new THREE.Vector3;var F=false;var Z=new THREE.Vector3;var J=new THREE.Vector3(0,0,0);var Q=0;d.setEnergyFromTo=function(e,t){K.set(e.x,e.y+.3,e.z);X.set(t.x,t.y,t.z)};d.setEnergyTransferring=function(e){F=e};d.updateEnergyBlocks=function(e,t){for(var r=0;r<q.length;r++){if(q[r].mesh.visible){var a=q[r].mesh;Z.set(X.x-a.position.x,X.y-a.position.y,X.z-a.position.z);var n=J.distanceTo(Z);Z.normalize();var i=t*.008;if(i>n){i=n}if(i<.001){a.visible=false}else{a.position.set(a.position.x+i*Z.x,a.position.y+i*Z.y,a.position.z+i*Z.z)}}}if(F){if(e-Q>50){for(var r=0;r<q.length;r++){if(q[r].mesh.visible==false){q[r].mesh.visible=true;g_sound.playSound(SOUND_ENERGY);q[r].mesh.position.set(K.x+Math.random()*.4-.2,K.y+Math.random()*.4-.2,K.z+Math.random()*.4-.2);break}}Q=e}}};var $=[];var ee=new THREE.Vector3;var te=new THREE.Vector3;var re=false;var ae=new THREE.Vector3;var ne=0;d.setEnergyDrainFromTo=function(e,t){ee.set(e.x,e.y,e.z);te.set(t.x,t.y+1.5,t.z)};d.setEnergyDrainTransferring=function(e){re=e};d.updateEnergyDrainBlocks=function(e,t){for(var r=0;r<$.length;r++){if($[r].mesh.visible){var a=$[r].mesh;ae.set(te.x-a.position.x,te.y-a.position.y,te.z-a.position.z);var n=J.distanceTo(ae);ae.normalize();var i=t*.008;if(i>n){i=n}if(i<.001){a.visible=false}else{a.position.set(a.position.x+i*ae.x,a.position.y+i*ae.y,a.position.z+i*ae.z)}}}if(re){if(e-ne>40){for(var r=0;r<$.length;r++){if($[r].mesh.visible==false){$[r].mesh.visible=true;g_sound.playSound(SOUND_ENERGY2);$[r].mesh.position.set(ee.x+Math.random()*.4-.2,ee.y+Math.random()*.4-.2,ee.z+Math.random()*.4-.2);break}}ne=e}}};function ie(){V=document.createElement("a-entity");V.setAttribute("class","non-removable");var e=new THREE.ConeGeometry(.4,1.8,3);var t=new THREE.MeshStandardMaterial({color:16776960,transparent:true});t.flatShading=true;var r=new THREE.Mesh(e,t);r.position.set(0,.9,0);V.setObject3D("mesh",r);var a=new THREE.IcosahedronGeometry(.4,1);var n=new THREE.Mesh(a,t);n.position.set(0,.7,0);r.add(n);var i=document.createElement("a-triangle");i.setAttribute("color","#eee");i.setAttribute("rotation","0 270 90");i.setAttribute("side","double");i.setAttribute("scale","0.2 0.26 0.2");i.setAttribute("position","0 1.65 -0.7");V.append(i);var o=document.createElement("a-text");o.setAttribute("value","Start Position");o.setAttribute("scale","3 3 3");o.setAttribute("side","double");o.setAttribute("color","#bbb");o.setAttribute("position","0 3 2");o.setAttribute("rotation","0 90 0");V.append(o);I=document.getElementById("player-collision-box");G.append(V)}function oe(){M=document.createElement("a-entity");M.setAttribute("class","non-removable");H=new Exit(M);i=document.createElement("a-text");i.setAttribute("value","Exit");i.setAttribute("scale","3 3 3");i.setAttribute("side","double");i.setAttribute("color","#bbb");i.setAttribute("position","0 3 0.6");i.setAttribute("rotation","0 90 0");M.append(i);G.append(M)}d.showEnergy=function(){var e=g.getEnergy();for(var t=0;t<ENERGY_MAX;t++){var r=document.getElementById("energy_"+t);if(t<e){r.style.backgroundColor="#0f0"}else{r.style.backgroundColor="#111"}}for(var t=0;t<z.length;t++){z[t].setEnergy(e)}};function se(e,t){if(e-m>2){r()}}function r(){o++;if(o>=g_levels.length){o=0;speak("Congratulations, you have finished all of the levels")}d.gotoLevel(o)}d.buildCollisionObjectList=function(){O=[];for(var e=0;e<L.length;e++){if(L[e].getIsSolid()){var t=L[e].getObject();O.push(t)}}if(A==STATE_PLAYING){I.object3D.isPlayer=true;if(I.object3D.children.length>0){I.object3D.children[0].isPlayer=true;O.push(I.object3D.children[0])}O.push(I.object3D)}};d.getCollisionObjects=function(){return O};d.init=function(){g=new Player(this);N=document.getElementById("player-shadow");G=document.getElementById("playfield");j=document.getElementById("playfield-holder");k=document.getElementById("level-text");_=document.getElementById("camera");y=document.getElementById("camera-offset");C=document.getElementById("level-info");g_raycaster=new THREE.Raycaster;g_raycaster.near=0;g_raycaster.far=1e4;w=document.getElementById("laser-left");P=new InfoPanel(document.getElementById("left-info"));z.push(P);var e=new THREE.MeshStandardMaterial({color:6711039,transparent:true,opacity:1,emissive:4474026});var t=new THREE.MeshStandardMaterial({color:16777215,transparent:true,opacity:1,emissive:16777215});e.flatShading=true;var r=new THREE.BoxGeometry(.05,.05,.05);for(var a=0;a<30;a++){var n=false;if(Math.random()>.7){n=new THREE.Mesh(r,e);var i=.5+Math.random()*.5;n.scale.set(i,i,i)}else{n=new THREE.Mesh(r,t);var i=Math.random()*.3;n.scale.set(i,i,i)}q.push({mesh:n});W.add(n)}for(var a=0;a<30;a++){var n=false;if(Math.random()>.7){n=new THREE.Mesh(r,e);var i=.5+Math.random()*.5;n.scale.set(i,i,i)}else{n=new THREE.Mesh(r,t);var i=Math.random()*.4;n.scale.set(i,i,i)}$.push({mesh:n});W.add(n)}w.addEventListener("buttondown",function(e){U=p;P.setButtonDown(true);if(g_leftButtonDownCount==0){g_leftButtonDownCount++;d.buttonDown(e)}if(A===STATE_LEVEL_PREVIEW){d.startLevel()}});w.addEventListener("buttonup",function(e){if(g_leftButtonDownCount>0){g_leftButtonDownCount--}P.setButtonDown(false);U=false;if(Y===false){v=false}d.buttonUp(e)});R=document.getElementById("laser-right");S=new InfoPanel(document.getElementById("right-info"));z.push(S);R.addEventListener("buttondown",function(e){Y=p;S.setButtonDown(true);if(A===STATE_LEVEL_PREVIEW){d.startLevel()}if(g_rightButtonDownCount==0){g_rightButtonDownCount++;d.buttonDown(e)}});R.addEventListener("buttonup",function(e){if(g_rightButtonDownCount>0){g_rightButtonDownCount--}S.setButtonDown(false);Y=false;if(U===false){v=false}d.buttonUp(e)});B=new StartButton(this);d.gotoLevel(g_startLevel)};d.buttonDown=function(e){for(var t=0;t<L.length;t++){L[t].buttonDown(e)}};d.buttonUp=function(e){for(var t=0;t<L.length;t++){L[t].buttonUp(e)}};d.clearLevel=function(){for(var e=0;e<L.length;e++){L[e].cleanup()}L=[];while(G.children.length>0){var t=false;for(var e=0;e<G.children.length;e++){if(G.children[e].getAttribute("class")!=="non-removable"){t=e;break}}if(t===false){break}else{G.removeChild(G.children[t])}}};d.setControllerInfoVisible=function(e){document.getElementById("left-info").object3D.visible=e;document.getElementById("right-info").object3D.visible=e};var le=function(){document.getElementById("instructions").innerHTML=""};var ue=function(){var e="";for(var t=0;t<4;t++){var r="";if(t<g_levels[o].text.length){r=g_levels[o].text[t]}e+=" "+r;P.setText(t,r);S.setText(t,r)}document.getElementById("instructions").innerHTML=e;speak(e)};d.modeChange=function(){if(g_vrMode){d.setControllerInfoVisible(true);N.object3D.visible=false}else{d.setControllerInfoVisible(false);N.object3D.visible=true}if(A==STATE_LEVEL_PREVIEW){ce()}};d.restartLevel=function(){d.gotoLevel(o)};function ce(){if(g_vrMode){G.setAttribute("position",new THREE.Vector3(-a*g_playfieldScale,1,n*g_playfieldScale));C.setAttribute("position","0 1 -0");B.setYPosition(1.8)}else{G.setAttribute("position",new THREE.Vector3(-a*g_playfieldScale,1.4,n*g_playfieldScale));C.setAttribute("position","0 0.1 0");B.setYPosition(.86)}}d.gotoLevel=function(e){le();P.setRestartText("");S.setRestartText("");d.clearLevel();o=e;A=STATE_LEVEL_PREVIEW;for(var t=0;t<4;t++){P.setText(t,"");S.setText(t,"")}var r=e+1;k.setAttribute("value","Level "+r);d.build();n=(b.z+T.z)/2;a=(b.x+T.x)/2;g_playfieldScale=.08;ce();G.setAttribute("scale",new THREE.Vector3(g_playfieldScale,g_playfieldScale,g_playfieldScale));G.setAttribute("rotation","0 180 0");g.setPosition(-1.2,0,0,0,-90,0);fe();if(!g_vrMode||g_vrMode===-1){_.setAttribute("look-controls",false);_.setAttribute("wasd-controls",false);_.object3D.rotation.set(0,0,0);_.setAttribute("rotation","0 0 0");_.setAttribute("look-controls",true);_.setAttribute("wasd-controls",true);_.components["look-controls"].pitchObject.rotation.x=0;_.components["look-controls"].yawObject.rotation.y=0}B.show();V.object3D.visible=true;k.object3D.visible=true;i.object3D.visible=true};d.getGameState=function(){return A};function fe(){h=-_.object3D.position.x;D=-_.object3D.position.z;y.object3D.position.setX(h);y.object3D.position.setZ(D)}function ve(){for(var e=0;e<L.length;e++){L[e].unhighlight()}}d.startLevel=function(){if(A==STATE_PLAYING){return}for(var e=0;e<L.length;e++){L[e].setClickable(true)}var r=0;ve();g.startTeleport(x.x,x.y,x.z,0,0,0,function(e,t){V.object3D.visible=false;i.object3D.visible=false;fe();g.setPosition(x.x,x.y,x.z,0,r,0);if(e=="arrived"){ve();G.setAttribute("position",new THREE.Vector3(0,0,0));G.setAttribute("rotation","0 0 0");g_playfieldScale=1;G.setAttribute("scale","1 1 1");k.object3D.visible=false;B.hide();ue()}});A=STATE_PLAYING;s=true};d.build=function(){T.x=1e4;T.y=1e4;T.z=1e4;b.x=-1e4;b.y=-1e4;b.z=-1e4;var e=g_levels[o].data;var t=g_levels[o].startRotation;rotationSpeed=70;if(typeof g_levels[o].robotSpeed!="undefined"){rotationSpeed=g_levels[o].robotSpeed}for(var r=0;r<e.length;r++){var a=e[r][0];var n=L.length;var i=new Pad(d,G,n,a);G.append(i.getEntity());T.x=Math.min(T.x,e[r][1]);T.y=Math.min(T.y,e[r][2]);T.z=Math.min(T.z,e[r][3]);b.x=Math.max(b.x,e[r][1]);b.y=Math.max(b.y,e[r][2]);b.z=Math.max(b.z,e[r][3]);i.setPosition(e[r][1],e[r][2],e[r][3]);i.setRotation(e[r][4],e[r][5],e[r][6]);i.setClickable(false);L.push(i);g.setEnergy(g_levels[o].energy);if(a==START_PAD){if(V==null){ie()}V.setAttribute("position",new THREE.Vector3(e[r][1],e[r][2],e[r][3]));V.setAttribute("rotation",new THREE.Vector3(0,t,0));x.set(e[r][1],e[r][2],e[r][3]);l=n}if(a==2){if(M==null){oe()}M.setAttribute("position",new THREE.Vector3(e[r][1],e[r][2],e[r][3]))}}O=[]};d.getCurrentPadIndex=function(){return l};d.getOnPad=function(){return s};d.noEnergy=function(){P.setText(0,"No Energy");P.setText(1,"Hold button for 1 second");P.setText(2,"to restart level");P.setText(3,"");S.setText(0,"No Energy");S.setText(1,"Hold button for 1 second");S.setText(2,"to restart level");S.setText(3,"")};d.hasEnergy=function(){for(var e=0;e<4;e++){var t="";if(e<g_levels[o].text.length){t=g_levels[o].text[e]}P.setText(e,t);S.setText(e,t)}};d.teleportPlayer=function(e,t,r,a,n,i,o,s){if(g.getEnergy()==0){if(g_vrMode){speak("No energy to teleport, hold the button for one second to restart")}else{speak("No energy to teleport")}return}if(o==2){g_sound.playSound(SOUND_DONE)}else{g_sound.playSound(SOUND_TELEPORT)}A=STATE_IN_TELEPORT;g.startTeleport(e,t,r,a,n,o,function(e,t){l=i;fe();for(var r=0;r<L.length;r++){L[r].playerTeleported(i,t)}if(typeof s!="undefined"){s()}if(e=="finished"){A=STATE_PLAYING;if(t==2){A=STATE_LEVEL_FINISHED;m=p;speak("Level Complete. Well done")}}});g.decreaseEnergy(o!==EXIT_PAD)};d.getPlayerPosition=function(){I.object3D.getWorldPosition(t);return t};d.getPlayer=function(){return g};d.increasePlayerEnergy=function(){g.increaseEnergy();g_sound.playSound(SOUND_ADD_ENERGY)};d.decreasePlayerEnergy=function(){g.decreaseEnergy()};d.gameOver=function(){if(A!==STATE_GAME_OVER){g_sound.playSound(SOUND_GAME_OVER);speak("Energy Drained. Game Over");d.setEnergyTransferring(false);d.setEnergyDrainTransferring(false);A=STATE_GAME_OVER;m=p}};d.tick=function(e,t){if(A==STATE_LEVEL_PREVIEW){}if(A==STATE_LEVEL_FINISHED){if(e-m>3200){A=STATE_TELEPORT_NEXT;m=e}}if(A==STATE_GAME_OVER){if(e-m>3600){d.gotoLevel(o)}}if(A==STATE_TELEPORT_NEXT){se(e,t)}d.buildCollisionObjectList();for(var r=0;r<L.length;r++){L[r].tick(e,t)}var a=_.object3D.position;N.object3D.position.setX(a.x+h);N.object3D.position.setZ(a.z+D);I.object3D.position.setX(a.x+h);I.object3D.position.setZ(a.z+D);I.object3D.position.setY(a.y-.24);if(A==STATE_PLAYING){var n=Math.sqrt((a.x+h)*(a.x+h)+(a.z+D)*(a.z+D));if(U!==false||Y!==false){var i=false;for(var r=0;r<L.length;r++){if(L[r].getInAbsorb()){i=true;break}}if(i){if(U!==false){U=e}if(Y!==false){Y=e}}}if(U!==false&&e-U>1200||Y!==false&&e-Y>2e3){if(!i){if(!v){speak("Button held for one second, the level will restart in three");P.setRestartText("Restarting Level...");S.setRestartText("Restarting Level...");v=true;E=e;f=3}if(f==3&&e-E>4600){speak("two");f--}if(f==2&&e-E>5400){speak("one");f--}if(f==1&&e-E>6200){speak("level restart");d.gotoLevel(o)}}}else{if(v){P.setRestartText("");S.setRestartText("")}v=false}if(n>1.5){if(s){s=false;u=e;c=false;f=3}if(e-u>400&&!c){speak("You are not on your pad, the level will restart in three");c=true;f=3;u=e+3e3}if(c){if(f==3&&e-u>1e3){speak("two");f--;u=e}if(f==2&&e-u>1e3){speak("one");f--;u=e}if(f==1&&e-u>1600){speak("level restart");d.gotoLevel(o)}}}else{if(s===false){speak("You are back on your pad")}s=true;c=false}}p=e;g.tick(e,t);H.tick(e,t);d.updateEnergyBlocks(e,t);d.updateEnergyDrainBlocks(e,t)}};var Player=function(t){var r=this;var s=document.getElementById("player");var _=document.getElementById("camera");var y=[];var l=new THREE.Vector3;var u=new THREE.Vector3;var c=false;var f=false;var v=false;var a=0;var E=false;var d=0;var g=8;var e=function(){var e;var t=10;for(e=0;e<t;e++){var r=e*360/t;var a=.07;var n=-Math.sin(r*2*Math.PI/360)*a;var i=-Math.cos(r*2*Math.PI/360)*a;var o=document.createElement("a-box");o.setAttribute("scale","0.05 0.04 0.001");o.setAttribute("color","#ffffff");if(e==0){o.setAttribute("color","#ffffff")}else if(e==1){o.setAttribute("color","#ff0000")}else if(e==2){o.setAttribute("color","#00ff00")}else if(e==3){o.setAttribute("color","#00ffff")}else{o.setAttribute("color","#ff00ff")}o.setAttribute("position",new THREE.Vector3(n,1.6,i));o.setAttribute("rotation",new THREE.Vector3(0,r,0));o.object3D.visible=false;s.append(o)}};var n=function(){var e=40;var t=1;var r=2*Math.PI*t;var a=r/e+.1;var n=0;var i=0;var o=0;var s=0;var l;var u;var c;var f=0;for(var v=0;v<e;v++){i=v*Math.PI*2/e;o=t*Math.cos(i);s=t*Math.sin(i);l=o;u=2*Math.PI*l;c=Math.round(u/a+.5);var E=[];for(var d=0;d<=c;d++){n=d*Math.PI*2/c;var g=l*Math.cos(n);var A=l*Math.sin(n);var T=document.createElement("a-plane");var b=a-.04+.15;var p=a-.1+.16;var m=.007;T.setAttribute("scale",new THREE.Vector3(b,p,m));T.setAttribute("color","#333333");T.setAttribute("material","side: double;shader: flat;");T.setAttribute("position",new THREE.Vector3(g,s+1,A));T.setAttribute("rotation",new THREE.Vector3(-(v*360/e),180/2-d*360/c,0));T.yPosition=s;T.object3D.visible=false;_.append(T);E.push(T);f++}if(E.length>0){y.push(E)}}y.sort(function(e,t){var r=e[0].yPosition-t[0].yPosition;return r})};r.getPosition=function(){return s.getAttribute("position")};r.getEnergy=function(){return g};r.increaseEnergy=function(){if(g<ENERGY_MAX){if(g==0){t.hasEnergy()}g++;t.showEnergy()}};r.decreaseEnergy=function(e){if(g>0){g--;t.showEnergy();if(g==0){if(typeof e==="undefined"||e===true){speak("Warning, zero energy")}t.noEnergy()}}else{t.gameOver()}};r.setEnergy=function(e){g=e;t.showEnergy()};r.startTeleport=function(e,t,r,a,n,i,o){if(g<=0){return}l.set(e,t,r);u.set(a,d,n);f=0;v=1;E=i;c=o};r.updateTeleport=function(){if(v===1){for(var e=0;e<y[f].length;e++){y[f][e].object3D.visible=true;y[f][e].setAttribute("color","#ffffff")}if(f>0){for(var e=0;e<y[f-1].length;e++){y[f-1][e].setAttribute("color","#cccccc")}}if(f>1){for(var e=0;e<y[f-1].length;e++){y[f-1][e].setAttribute("color","#aaaaaa")}}f++;if(f>=y.length){f=0;v=-1;r.moveToTeleport()}}else if(v===-1){for(var e=0;e<y[f].length;e++){y[f][e].object3D.visible=false;y[f][e].setAttribute("color","#ffffff")}f++;if(f>=y.length){v=false;if(typeof c!="undefined"){c("finished",E)}}}};r.setPosition=function(e,t,r,a,n,i){d=n;s.setAttribute("position",new THREE.Vector3(e,t,r));s.setAttribute("rotation",new THREE.Vector3(a,n,i))};r.moveToTeleport=function(){var e=0;var t=0;var r=0;switch(u.z){case 90:r=-1;break;case 180:e=-1;break;case 270:r=1;break}switch(u.x){case 90:t=1;break;case 180:e=-1;break;case 270:t=-1;break}if(u.x==0&&u.z==0){e=1}e=0;t=0;r=0;s.setAttribute("position",new THREE.Vector3(l.x+r,l.y+e,l.z+t));s.setAttribute("rotation",new THREE.Vector3(u.x,d,u.z));if(typeof c!="undefined"){c("arrived",E)}};r.tick=function(e,t){if(e-a>30){if(v!==false){r.updateTeleport()}a=e}};n()};var Exit=function(e){var t=this;var a=0;var r=document.createElement("a-cylinder");r.setAttribute("color","#0044ff");r.setAttribute("opacity","0.6");r.setAttribute("scale","0.44 0.02 0.44");r.setAttribute("position","0 0.02 0");e.append(r);var n=[];var i=new THREE.BoxGeometry(.1,30,.1);for(var o=0;o<30;o++){var s=new THREE.MeshStandardMaterial({color:1118719,transparent:true,opacity:.8,emissive:4474111});var l=new THREE.MeshStandardMaterial({color:16777215,transparent:true,opacity:.8,emissive:16777215});s.flatShading=true;var u=false;if(Math.random()>.7){u=new THREE.Mesh(i,s);var c=.5+Math.random()*.5;u.scale.set(c,c,c)}else{u=new THREE.Mesh(i,l);var c=Math.random()*.3;u.scale.set(c,c,c)}n.push({mesh:u});r.object3D.add(u)}t.tick=function(e,t){for(var r=0;r<n.length;r++){if(n[r].mesh.visible){distance=n[r].mesh.position.y+t*.06;n[r].mesh.material.opacity=(120-distance)/120;if(distance>120){n[r].mesh.visible=false}n[r].mesh.position.setY(distance)}}if(e-a>50){for(var r=0;r<n.length;r++){if(n[r].mesh.visible==false){n[r].mesh.visible=true;n[r].mesh.material.opacity=.6;n[r].mesh.position.set(Math.random()*1.5-.7,12,Math.random()*1.5-.7);break}}a=e}}};var rotationSpeed=70;var Pad=function(g,e,t,r){var a=this;var o=false;var s=false;var l=false;var u=false;var n=false;var c=new THREE.Vector3(0,1,0);var f=r;var v=true;var i=t;var A=false;var T=false;var E=false;var d=false;var b=[];var p=false;var m=0;var _=null;var y=false;var h=false;var D=new THREE.Vector3;var R=new THREE.Vector3(0,0,-1);var P=false;var w=g_scene.object3D;var S=false;var L=false;var O=false;var V=0;var N=0;var I=0;var x=0;var M=0;var H=0;var k=false;var B=false;a.setClickable=function(e){if(!s){return}if(e){s.setAttribute("class","clickable")}else{s.setAttribute("class","")}};var G=function(){if(o===false){o=document.createElement("a-entity")}if(f!==BLOCKING_PAD){s=document.createElement("a-box");switch(f){case GREEN_PAD:s.setAttribute("color","#00aa00");break;case RED_PAD:s.setAttribute("color","#aa0000");break;default:s.setAttribute("color","#aaaaaa")}s.setAttribute("transparent",true);s.setAttribute("opacity","1");s.setAttribute("scale","1.06 0.02 1.06");s.setAttribute("position",new THREE.Vector3(0,-.01,0));s.addEventListener("mouseenter",q);s.addEventListener("mouseleave",K);s.addEventListener("mousedown",function(e){return;var t=false;if(e.detail){if(e.detail.cursorEl){t=e.detail.cursorEl}}if(g_scene==t){t=null}if(t){var r=t.getAttribute("position");console.log("position = ");console.log(r)}else{console.log("NO ORIGIN")}O=false;if(S){j();O=true}else{}});s.addEventListener("mouseup",function(e){});s.addEventListener("click",X);v=true;o.append(s)}u=document.createElement("a-box");switch(f){case GREEN_PAD:u.setAttribute("color","#00ee00");break;case RED_PAD:u.setAttribute("color","#ee0000");break;default:u.setAttribute("color","#eeeeee")}u.setAttribute("transparent",true);u.setAttribute("opacity","1");u.setAttribute("scale","1.6 0.2 1.6");u.setAttribute("position",new THREE.Vector3(0,-.12,0));u.setAttribute("class","clickable");o.append(u);if(f===PAD_WITH_ROBOT){T=document.createElement("a-entity");var e=new THREE.ConeGeometry(.4,1.8,4);E=new THREE.MeshStandardMaterial({color:3684424,transparent:true});E.flatShading=true;p=new THREE.Mesh(e,E);p.position.set(0,.9,0);T.setObject3D("mesh",p);var t=new THREE.ConeGeometry(.3,.6,3);var r=new THREE.Mesh(t,E);r.rotateX(-Math.PI/1.6);r.position.set(0,.8,-.2);p.add(r);_=new THREE.LineBasicMaterial({color:16711680,transparent:true});o.append(T);for(var a=0;a<12;a++){var n=[];n.push(new THREE.Vector3(0,0,0));n.push(new THREE.Vector3(0,10,0));var e=(new THREE.BufferGeometry).setFromPoints(n);var i=new THREE.Line(e,_);b.push({mesh:i,geometry:e});w.add(i)}S=true}return o};a.getObject=function(){return o.object3D};var C=function(){if(!S||T==null){return}var e=g_playfieldScale;var t=new THREE.Vector3;T.setAttribute("rotation","0 "+m+" 0");p.getWorldPosition(t);t.setY(t.y+1*e);var r=new THREE.Vector3;var a=g.getCollisionObjects();var n=6*e;var i=(m+90)*Math.PI/180;if(g.getGameState()==STATE_LEVEL_PREVIEW){i=(m-90)*Math.PI/180}k=false;for(var o=0;o<b.length;o++){var s=-o*5*Math.PI/180;var l=b[o].geometry.attributes.position.array;var u=0;l[u++]=t.x;l[u++]=t.y;l[u++]=t.z;var c=t.x+n*Math.cos(s);var f=t.y+n*Math.sin(s);var v=t.z;var E=c-t.x;c=t.x+E*Math.cos(-i);v=t.z+E*Math.sin(-i);r.setX(c-t.x);r.setY(f-t.y);r.setZ(v-t.z);r.normalize();g_raycaster.set(t,r);g_raycaster.near=0;g_raycaster.far=n;var d=g_raycaster.intersectObjects(a,true);if(d.length>0){c=d[0].point.x;f=d[0].point.y;v=d[0].point.z;if(typeof d[0].object.isPlayer!="undefined"){k=true;if(!B){B=true;g.setEnergyDrainTransferring(true);g.decreasePlayerEnergy();g_sound.playSound(SOUND_ENERGY);y=A}}}l[u++]=c;l[u++]=f;l[u++]=v;b[o].geometry.attributes.position.needsUpdate=true;b[o].geometry.computeBoundingBox();b[o].geometry.computeBoundingSphere()}};a.getInAbsorb=function(){return L!==false};var j=function(){L=A;g.setEnergyTransferring(true)};var z=function(){L=false;g.setEnergyTransferring(false);if(E){E.opacity=1;_.opacity=1}};var U=function(){if(!S){return}S=false;L=false;g.setEnergyTransferring(false);o.removeChild(T);T=null;g.increasePlayerEnergy();if(B){B=false;g.setEnergyDrainTransferring(false)}for(var e=0;e<b.length;e++){w.remove(b[e].mesh);b[e].geometry.dispose()}b=[]};a.cleanup=function(){U()};var Y=function(){if(i===g.getCurrentPadIndex()){return false}if(!g.getOnPad()){return false}var e=g.getPlayer().getPosition();var t=new THREE.Vector3(e.x-V,e.y-N,e.z-I);return t.dot(c)>=0};var W=function(){if(g.getGameState()==STATE_PLAYING&&Y()){g_sound.playSound(SOUND_CLICK);switch(f){case GREEN_PAD:s.setAttribute("color","#8f8");break;case RED_PAD:s.setAttribute("color","#f88");break;default:s.setAttribute("color","#ffd")}}};a.unhighlight=function(){P=false;if(s){switch(f){case GREEN_PAD:s.setAttribute("color","#0a0");break;case RED_PAD:s.setAttribute("color","#a00");break;default:s.setAttribute("color","#aaa")}}};var q=function(e){P=true;W()};var K=function(e){P=false;a.unhighlight()};var X=function(e){};a.buttonDown=function(e){if(P){if(g.getGameState()==STATE_PLAYING){var t=false;if(e.detail){if(e.detail.cursorEl){t=e.detail.cursorEl}}if(g_scene==t){t=null}if(t){h=t}else{}O=false;if(S){j();O=true}else{}}if(g.getGameState()==STATE_PLAYING&&Y()&&!S){g.teleportPlayer(V,N,I,x,H,i,f,function(){a.unhighlight()})}}};a.buttonUp=function(e){if(L!==false){z()}};a.playerTeleported=function(e,t){if(f==BLOCKING_PAD){return}if(f===t&&i!==e&&f!==NORMAL_PAD&&f!=PAD_WITH_ROBOT){s.setAttribute("wireframe",true);u.setAttribute("wireframe",true);u.setAttribute("opacity",.4);u.setAttribute("class","");s.setAttribute("class","");v=false}else{if(s){s.setAttribute("wireframe",false);s.setAttribute("class","clickable")}u.setAttribute("wireframe",false);u.setAttribute("opacity",1);u.setAttribute("class","clickable");v=true}B=false;g.setEnergyDrainTransferring(false);a.unhighlight()};a.getIsSolid=function(){return v};a.getIndex=function(){return i};a.getEntity=function(){return o};a.setPosition=function(e,t,r){V=e;N=t;I=r;o.setAttribute("position",new THREE.Vector3(e,t,r))};a.setRotation=function(e,t,r){x=e;M=t;H=r;o.setAttribute("rotation",new THREE.Vector3(e,t,r));var a=0;var n=0;var i=0;switch(r){case 90:a=-1;break;case 180:n=-1;break;case 270:a=1;break}switch(e){case 90:i=1;break;case 180:n=-1;break;case 270:i=-1;break}c.set(a,n,i)};a.getPosition=function(){return o.getAttribute("position")};a.tick=function(e,t){if(S){if(L!==false){var r=e-L;if(l===false){l=new THREE.Vector3(0,0,0);s.object3D.getWorldPosition(l)}D.set(0,0,0);if(h){h.object3D.getWorldPosition(D)}else{var a=g.getPlayerPosition();D.set(a.x,a.y-.05,a.z)}g.setEnergyFromTo(l,D);if(r>2e3){U()}else{E.opacity=(1800-r)/1800;_.opacity=(1800-r)/1800}}if(B){var a=g.getPlayerPosition();var n=p.worldToLocal(a);n.setY(0);var i=R.angleTo(n);i=i*180/Math.PI;if(n.x<0){m+=i}else{m-=i}if(l===false){l=new THREE.Vector3(0,0,0);s.object3D.getWorldPosition(l)}D.set(0,0,0);var a=g.getPlayerPosition();D.set(a.x,a.y-.05,a.z);g.setEnergyDrainFromTo(D,l);if(e-y>2e3){g.decreasePlayerEnergy();g_sound.playSound(SOUND_REMOVE);y=e}}else if(!k){m=(m+t/rotationSpeed)%360}C()}A=e};G()};g_sound=null;var SOUND_CLICK=1;var SOUND_TELEPORT=2;var SOUND_DIE=3;var SOUND_FALL=5;var SOUND_REMOVE=8;var SOUND_PLACE=9;var SOUND_LEVEL_END=10;var SOUND_ENERGY=11;var SOUND_ENERGY2=12;var SOUND_DONE=13;var SOUND_GAME_OVER=14;var SOUND_ADD_ENERGY=15;var Sound=function(){var l=null;this.init=function(){if(l==null){l=new AudioContext}};var u=function(e){return Math.pow(2,(e-69)/12)*440};this.playSound=function(e){if(l==null){return}var t=l.currentTime;var r=1/16;var a=1/64;var n=r;var i=l.createGain();var o=null;var s=null;o=l.createOscillator();o.type="square";o.connect(i);i.connect(l.destination);switch(e){case SOUND_REMOVE:r=1/32;o.type="triangle";o.frequency.setValueAtTime(u(45),t);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.3,l.currentTime+1/16);i.gain.linearRampToValueAtTime(0,l.currentTime+r*3);n=r*3;break;case SOUND_ENERGY:r=1/32;o.type="triangle";o.frequency.setValueAtTime(u(45),t);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.3,l.currentTime+1/16);i.gain.linearRampToValueAtTime(0,l.currentTime+r*3);n=r*3;break;case SOUND_ENERGY2:r=1/32;o.type="sawtooth";o.frequency.setValueAtTime(u(33),t);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.2,l.currentTime+1/16);i.gain.linearRampToValueAtTime(0,l.currentTime+r*3);n=r*3;break;case SOUND_PLACE:case SOUND_CLICK:r=1/32;o.type="triangle";o.frequency.setValueAtTime(u(60),t);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.3,l.currentTime+1/128);i.gain.linearRampToValueAtTime(0,l.currentTime+r*3);n=r*3;break;case SOUND_FALL:r=1/4;o.type="triangle";o.frequency.setValueAtTime(u(62),t);o.frequency.linearRampToValueAtTime(u(55),t+r*4);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.3,l.currentTime+1/128);i.gain.linearRampToValueAtTime(0,l.currentTime+r*3);n=r*4;break;case SOUND_DIE:r=1/12;o.type="sawtooth";o.frequency.setValueAtTime(u(56),t);o.frequency.linearRampToValueAtTime(u(49),t+r);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.2,l.currentTime+r);i.gain.linearRampToValueAtTime(0,l.currentTime+r*2);n=r*2;break;case SOUND_ADD_ENERGY:r=1/12;o.type="triangle";o.frequency.setValueAtTime(u(55),t);o.frequency.setValueAtTime(u(62),t+r);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.2,l.currentTime+1/64);i.gain.linearRampToValueAtTime(0,l.currentTime+r*2);n=r*2;break;case SOUND_TELEPORT:r=1/12;o.type="triangle";o.frequency.setValueAtTime(u(55),t);o.frequency.setValueAtTime(u(62),t+r);o.frequency.setValueAtTime(u(67),t+r*2);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.3,l.currentTime+1/64);i.gain.linearRampToValueAtTime(0,l.currentTime+r*6);n=r*6;break;case SOUND_DONE:r=1/12;o.type="sawtooth";o.frequency.setValueAtTime(u(43),t);o.frequency.setValueAtTime(u(50),t+r*4);o.frequency.setValueAtTime(u(48),t+r*8);o.frequency.setValueAtTime(u(41),t+r*12);o.frequency.setValueAtTime(u(43),t+r*16);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.18,l.currentTime+1/32);i.gain.linearRampToValueAtTime(0,l.currentTime+r*26);n=r*26;break;case SOUND_GAME_OVER:r=1/12;o.type="sawtooth";o.frequency.setValueAtTime(u(50),t);o.frequency.setValueAtTime(u(41),t+r*4);o.frequency.setValueAtTime(u(43),t+r*8);i.gain.setValueAtTime(0,t);i.gain.linearRampToValueAtTime(.2,l.currentTime+1/64);i.gain.linearRampToValueAtTime(0,l.currentTime+r*14);n=r*14;break}o.start(l.currentTime);o.stop(l.currentTime+n)}};var StartButton=function(e){var t=this;var r=document.getElementById("playfield-holder");var a=document.getElementById("level-text");var n=document.getElementById("start-button");var i=document.createElement("a-box");i.setAttribute("color","#00f");i.setAttribute("scale","0.05 0.25 1");i.setAttribute("position","0 0.1 0.5");i.setAttribute("class","clickable");i.setAttribute("visible",false);n.append(i);r.append(n);i.addEventListener("click",function(){g_sound.init();g_sound.playSound(SOUND_CLICK);e.startLevel()});i.addEventListener("mouseenter",function(){a.setAttribute("color","#fff");g_sound.playSound(SOUND_CLICK)});i.addEventListener("mouseleave",function(){a.setAttribute("color","#aaa")});t.hide=function(){i.setAttribute("class","");n.object3D.visible=false};t.show=function(){i.setAttribute("class","clickable");n.object3D.visible=true};t.setYPosition=function(e){n.object3D.position.setY(e)}};var START_PAD=1;var EXIT_PAD=2;var NORMAL_PAD=3;var PAD_WITH_ROBOT=4;var GREEN_PAD=5;var RED_PAD=6;var BLOCKING_PAD=7;var g_levels=[{text:["Level 1.","Select a pad to teleport to.","Each teleport will use one","unit of energy."],startRotation:0,energy:8,data:[[START_PAD,0,0,0,0,0,0],[NORMAL_PAD,0,.4,-6,0,0,0],[NORMAL_PAD,-2,1.1,-12,0,0,0],[NORMAL_PAD,2,1.1,-12,0,0,0],[EXIT_PAD,0,2,-18,0,0,0]]},{text:["Level 2.","If a robot sees you","it will drain your energy.",""],energy:8,robotSpeed:60,data:[[START_PAD,0,0,0,0,0,0],[PAD_WITH_ROBOT,-2.5,2.9,-7,0,0,0],[NORMAL_PAD,0,.5,-7,0,0,0],[NORMAL_PAD,0,1.5,-12,0,0,0],[PAD_WITH_ROBOT,2,2.9,-12,0,0,0],[EXIT_PAD,0,2.3,-20,0,0,0]]},{text:["Level 3.","You can absorb a robot's"," energy by selecting it's pad.",""],startRotation:0,energy:2,data:[[START_PAD,0,0,0,0,0,0],[NORMAL_PAD,2.5,-.5,-8,0,0,0],[PAD_WITH_ROBOT,-2.5,-.5,-8,0,0,0],[NORMAL_PAD,.5,4,-19,0,0,270],[EXIT_PAD,4,3.5,-17,0,0,0]]},{text:["Level 4.","When on a green pad,","other green pads will","disappear",""],energy:4,robotSpeed:30,data:[[START_PAD,0,0,3,0,0,0],[GREEN_PAD,0,0,-3,0,0,0],[GREEN_PAD,0,2.4,-10,0,0,0],[PAD_WITH_ROBOT,-3.5,2.5,-10,0,0,0],[PAD_WITH_ROBOT,3.5,2.5,-10,0,0,0],[GREEN_PAD,2,3.6,-10,0,0,90],[BLOCKING_PAD,2.4,3.6,-9,90,0,0],[GREEN_PAD,-2,3.6,-10,0,0,270],[BLOCKING_PAD,-2.4,3.6,-9,90,0,0],[NORMAL_PAD,0,7,-8,0,0,180],[BLOCKING_PAD,0,6,-6,90,0,0],[BLOCKING_PAD,0,3.5,-19,270,0,0],[EXIT_PAD,0,3.5,-20,0,0,0],[NORMAL_PAD,5.5,6.5,-22,0,0,90],[GREEN_PAD,5.5,6.5,-21,270,0,0],[NORMAL_PAD,-5.5,6.5,-22,0,0,270],[GREEN_PAD,-5.5,6.5,-21,270,0,0]]},{text:["Level 5.","When on a red pad,","other red pads will","disappear",""],energy:2,robotSpeed:40,data:[[START_PAD,0,0,3,0,0,0],[RED_PAD,0,0,-5,0,0,0],[PAD_WITH_ROBOT,4,0,-5,0,0,0],[RED_PAD,3.5,0,-3.5,90,0,0],[BLOCKING_PAD,3.5,.2,-6,90,0,0],[RED_PAD,3,2,-5,0,0,90],[PAD_WITH_ROBOT,-4,0,-5,0,0,0],[RED_PAD,-3.5,0,-3.5,90,0,0],[BLOCKING_PAD,-3.5,.2,-6,90,0,0],[RED_PAD,-3,2,-5,0,0,270],[RED_PAD,0,5,-12,270,0,0],[GREEN_PAD,0,6.5,-19,90,0,0],[NORMAL_PAD,0,12.5,-16.5,0,0,180],[GREEN_PAD,0,12.4,-16.5,0,0,0],[EXIT_PAD,0,6,-21,0,0,0]]},{text:["Level 6.","","","",""],energy:5,robotSpeed:40,data:[[START_PAD,0,2,3,0,0,0],[RED_PAD,2.5,0,-6,0,0,0],[BLOCKING_PAD,-.1,2,-6,0,0,90],[BLOCKING_PAD,-.1,.6,-6,0,0,90],[GREEN_PAD,-2.5,0,-6,0,0,0],[RED_PAD,-5.5,13.9,-12,0,0,0],[GREEN_PAD,-5.5,14,-12,0,0,180],[RED_PAD,5.5,10,-16,90,0,0],[GREEN_PAD,5.5,10,-15.7,90,0,0],[BLOCKING_PAD,3.2,7.5,-8,90,0,0],[BLOCKING_PAD,0,9.7,-20,90,0,0],[EXIT_PAD,0,9,-21,0,0,0],[BLOCKING_PAD,-.9,9.7,-21,0,0,90],[BLOCKING_PAD,.7,9.7,-21,0,0,90],[BLOCKING_PAD,-2.8,11.6,-20,90,0,0],[BLOCKING_PAD,-1.4,5,-14,90,0,0],[RED_PAD,2,4.9,-18,0,0,0],[BLOCKING_PAD,-.1,6.9,-18,0,0,90],[BLOCKING_PAD,-.1,5.5,-18,0,0,90],[GREEN_PAD,-2,4.9,-18,0,0,0],[RED_PAD,0,11,-28,90,0,0],[GREEN_PAD,0,11,-27.9,270,0,0]]},{text:["Level 7.","","","",""],energy:3,robotSpeed:30,data:[[START_PAD,0,3,4,0,0,0],[PAD_WITH_ROBOT,2,0,-5,0,0,0],[NORMAL_PAD,-2,0,-5,0,0,0],[GREEN_PAD,-4,6.5,-6.3,270,0,0],[RED_PAD,-7,8,-15,0,0,270],[PAD_WITH_ROBOT,-3.5,7.5,-15,0,0,0],[GREEN_PAD,4,12,-24,270,0,0],[RED_PAD,4,12,-24,90,0,0],[EXIT_PAD,0,9,-21,0,0,0]]},{text:["Level 8.","","","",""],energy:3,robotSpeed:30,data:[[START_PAD,0,0,4,0,0,0],[PAD_WITH_ROBOT,0,6,-6,0,0,0],[RED_PAD,0,5.4,-6,180,0,0],[NORMAL_PAD,0,7.5,-12.2,90,0,0],[RED_PAD,0,7.5,-12,270,0,0],[RED_PAD,0,11,-1.5,270,0,0],[EXIT_PAD,0,7.5,-21,0,0,0]]}];var english_voice="";var available_voices=window.speechSynthesis.getVoices();var utterance=false;function speak(e){if(!available_voices||available_voices.length==0){available_voices=window.speechSynthesis.getVoices()}if(english_voice==""){for(var t=0;t<available_voices.length;t++){if(available_voices[t].lang==="en-GB"){english_voice=available_voices[t];break}}if(english_voice===""&&available_voices.length>0){english_voice=available_voices[0]}}if(utterance){window.speechSynthesis.cancel(utterance)}utterance=new SpeechSynthesisUtterance;utterance.text=e;if(english_voice!=""){utterance.voice=english_voice}window.speechSynthesis.speak(utterance)}var InfoPanel=function(e){var t=this;var r=[];var a=document.createElement("a-entity");var n=document.createElement("a-plane");n.setAttribute("scale","1.2 1.8 1");n.setAttribute("color","#222");a.append(n);var i=document.createElement("a-text");i.setAttribute("value","Energy");i.setAttribute("position","-0.55 0.7 0");a.append(i);var o=[];for(var s=0;s<4;s++){o[s]=document.createElement("a-text");o[s].setAttribute("value","Info line 1 ");o[s].setAttribute("position",new THREE.Vector3(-.54,.15-.15*s,0));o[s].setAttribute("scale","0.4 0.4 0.4");o[s].setAttribute("anchor","left");a.append(o[s])}var l=document.createElement("a-text");l.setAttribute("value","");l.setAttribute("position",new THREE.Vector3(-.38,-.76,0));l.setAttribute("scale","0.3 0.3 0.3");l.setAttribute("anchor","left");a.append(l);for(var s=0;s<8;s++){var u=document.createElement("a-plane");u.setAttribute("color","#0f0");u.setAttribute("scale","0.1 0.1 0.1");u.setAttribute("position",new THREE.Vector3(-.46+s*.12,.43,.02));r.push(u);a.append(u)}var c=document.createElement("a-plane");c.setAttribute("scale","0.1 0.1 0.1");c.setAttribute("position",new THREE.Vector3(-.46,-.76,.02));c.setAttribute("color","#111");a.append(c);e.append(a);t.setEnergy=function(e){if(e>=r.length){e=r.length}var t=0;for(t=0;t<e;t++){r[t].setAttribute("color","#0f0")}for(t=e;t<r.length;t++){r[t].setAttribute("color","#111")}};t.setRestartText=function(e){l.setAttribute("value",e)};t.setButtonDown=function(e){if(e){c.setAttribute("color","#f90")}else{c.setAttribute("color","#111")}};t.setText=function(e,t){o[e].setAttribute("value",t)}};